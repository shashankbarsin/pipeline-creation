trigger:
- master

resources:
- repo: self

variables:
  # container registry service connection established during pipeline creation - Docker Hub/ACR/...
  ContainerRegistry.Serviceconnection: '{{containerRegistryServiceConnection}}'
  Image.Repository: '$(Build.Repository.Name)'
  
steps:
  - use: docker
    auth:
    - $(ContainerRegistry.ServiceConnection)
  - script: |
      docker build -t $(ContainerRegistry.Name)/$(Image.Repository):$(Image.Tag)
      docker push $(ContainerRegistry.Name)/$(Image.Repository):$(Image.Tag)